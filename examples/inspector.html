<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Select UI â€• Inspector</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script type="importmap">
		{"imports": {"@./": "../src/js/" } }
	</script>
</head>

<body>
	<div id="ui"></div>

	<template id="InspectSymbol">
		Symbol <span out="value"></span>
	</template>

	<template id="InspectNumber">
		Number <span out="value"></span>
	</template>

	<template id="InspectString">
		String <span out="value"></span>
	</template>

	<template id="InspectList">
		<div>
			List
			(<span out="count"></span>):
			<div out="items"></div>
		</div>
	</template>

	<template id="InspectDict">
		<div>
			Dict
			(<span out="count"></span>):
			<div out="items"></div>
		</div>
	</template>

	<template id="Inspector">
		<div out="value">
		</div>
	</template>

	<script type="module">
		import {ui, type, remap} from "@./select.ui.js"
		const item = (value) => {
			const t = type(value)
			switch (t) {
				case type.Null:
					return InspectSymbol({value})
				case type.List:
					return InspectList({value})
				case type.Dict:
					return InspectDict({value})
				case type.String:
					return InspectString({value})
				case type.Number:
					return InspectNumber({value})
				default:
					return InspectList({value})
			}
		}
		const InspectDict = ui("#InspectDict").does({
			count: ({value}) => Object.keys(value).length,
			items: ({value}) => remap(value, _ => item(value)),
		})

		const InspectList = ui("#InspectList").does({
			count: ({value}) => value?.length || 0,
			items: ({value}) => remap(value, _ => item(value)),
		})
		const InspectString = ui("#InspectString").does({
			value: _ => _,
		})
		const InspectNumber = ui("#InspectNumber").does({
			value: _ => _,
		})
		const InspectSymbol = ui("#InspectSymbol").does({
			value: _ => _,
		})
		// Inspector
		const Inspector = ui("#Inspector").does({
			value: ({value}) => item(value),
		})
		const c = Inspector.make();
		c.mount("#ui");
		console.log("C", c)
		const data = await fetch("https://cdn.statically.io/gh/sebastien/ui.js/5c3258b1bb775e1529fffcc04cd623f253c50a9a/examples/inspector-speed.json").then(_ => _.json());
		console.log("DATA", data)
		c.set({value: data})
		window.Inspector = Inspector;
	</script>
</body>

</html>
